use bateriacamiondb;

select * from detalle_baterias;

INSERT INTO detalle_baterias (corriente, carga, dia, est_dc, hora, temperatura, voltaje, bat_id)
VALUES
 -- 6
  (32.2, 50, '2023-06-01', 1, '12:00:00', 25.5, 11.3, 1),
  (32.2, 50, '2023-06-01', 1, '13:00:00', 20.5, 12.3, 1),
  (32.2, 50, '2023-06-01', 1, '14:00:00', 21.5, 10.4, 1),
  (32.2, 50, '2023-06-01', 1, '15:00:00', 12.5, 10.3, 1),
  (32.2, 50, '2023-06-01', 1, '16:00:00', 30.2, 11.7, 1),
  (32.2, 50, '2023-06-01', 1, '17:00:00', 22.5, 14.9, 1),
  (32.2, 50, '2023-06-01', 1, '18:00:00', 25.5, 16.3, 1),
  (32.2, 50, '2023-06-01', 1, '19:00:00', 28.5, 14.3, 1),
  (32.2, 50, '2023-06-01', 1, '20:00:00', 21.5, 11.3, 1),
  (32.2, 50, '2023-06-01', 1, '21:00:00', 19.4, 11.3, 1),
  
  (32.2, 50, '2023-06-02', 1, '12:00:00', 25.5, 11.3, 1),
  (32.2, 50, '2023-06-02', 1, '13:00:00', 20.5, 12.3, 1),
  (32.2, 50, '2023-06-02', 1, '14:00:00', 21.5, 10.4, 1),
  (32.2, 50, '2023-06-02', 1, '15:00:00', 12.5, 10.3, 1),
  (32.2, 50, '2023-06-02', 1, '16:00:00', 30.2, 11.7, 1),
  (32.2, 50, '2023-06-02', 1, '17:00:00', 22.5, 14.9, 1),
  (32.2, 50, '2023-06-02', 1, '18:00:00', 25.5, 16.3, 1),
  (32.2, 50, '2023-06-02', 1, '19:00:00', 28.5, 14.3, 1),
  (32.2, 50, '2023-06-02', 1, '20:00:00', 21.5, 11.3, 1),
  (32.2, 50, '2023-06-02', 1, '21:00:00', 19.4, 11.3, 1),
  
  (32.2, 50, '2023-06-03', 1, '12:00:00', 22.5, 13.3, 1),
  (32.2, 50, '2023-06-03', 1, '13:00:00', 21.5, 16.3, 1),
  (32.2, 50, '2023-06-03', 1, '14:00:00', 19.5, 14.4, 1),
  (32.2, 50, '2023-06-03', 1, '15:00:00', 12.2, 15.3, 1),
  (32.2, 50, '2023-06-03', 1, '16:00:00', 21.2, 16.7, 1),
  (32.2, 50, '2023-06-03', 1, '17:00:00', 25.5, 12.9, 1),
  (32.2, 50, '2023-06-03', 1, '18:00:00', 15.5, 19.3, 1),
  (32.2, 50, '2023-06-03', 1, '19:00:00', 23.5, 18.3, 1),
  (32.2, 50, '2023-06-03', 1, '20:00:00', 21.5, 12.3, 1),
  (32.2, 50, '2023-06-03', 1, '21:00:00', 19.4, 13.3, 1),
  
  (32.2, 50, '2023-06-04', 1, '12:00:00', 22.5, 13.3, 1),
  (32.2, 50, '2023-06-04', 1, '13:00:00', 21.5, 16.3, 1),
  (32.2, 50, '2023-06-04', 1, '14:00:00', 19.5, 14.4, 1),
  (32.2, 50, '2023-06-04', 1, '15:00:00', 12.2, 15.3, 1),
  (32.2, 50, '2023-06-04', 1, '16:00:00', 21.2, 16.7, 1),
  (32.2, 50, '2023-06-04', 1, '17:00:00', 25.5, 12.9, 1),
  (32.2, 50, '2023-06-04', 1, '18:00:00', 15.5, 19.3, 1),
  (32.2, 50, '2023-06-04', 1, '19:00:00', 23.5, 18.3, 1),
  (32.2, 50, '2023-06-04', 1, '20:00:00', 21.5, 12.3, 1),
  (32.2, 50, '2023-06-04', 1, '21:00:00', 19.4, 13.3, 1),
  
  (32.2, 50, '2023-06-05', 1, '12:00:00', 22.5, 13.3, 1),
  (32.2, 50, '2023-06-05', 1, '13:00:00', 21.5, 16.3, 1),
  (32.2, 50, '2023-06-05', 1, '14:00:00', 19.5, 14.4, 1),
  (32.2, 50, '2023-06-05', 1, '15:00:00', 12.2, 15.3, 1),
  (32.2, 50, '2023-06-05', 1, '16:00:00', 21.2, 16.7, 1),
  (32.2, 50, '2023-06-05', 1, '17:00:00', 25.5, 12.9, 1),
  (32.2, 50, '2023-06-05', 1, '18:00:00', 15.5, 19.3, 1),
  (32.2, 50, '2023-06-05', 1, '19:00:00', 23.5, 18.3, 1),
  (32.2, 50, '2023-06-05', 1, '20:00:00', 21.5, 12.3, 1),
  (32.2, 50, '2023-06-05', 1, '21:00:00', 19.4, 13.3, 1),
  
  (32.2, 50, '2023-06-06', 1, '12:00:00', 22.5, 13.3, 1),
  (32.2, 50, '2023-06-06', 1, '13:00:00', 21.5, 16.3, 1),
  (32.2, 50, '2023-06-06', 1, '14:00:00', 19.5, 14.4, 1),
  (32.2, 50, '2023-06-06', 1, '15:00:00', 12.2, 15.3, 1),
  (32.2, 50, '2023-06-06', 1, '16:00:00', 21.2, 16.7, 1),
  (32.2, 50, '2023-06-06', 1, '17:00:00', 25.5, 12.9, 1),
  (32.2, 50, '2023-06-06', 1, '18:00:00', 15.5, 19.3, 1),
  (32.2, 50, '2023-06-06', 1, '19:00:00', 23.5, 18.3, 1),
  (32.2, 50, '2023-06-06', 1, '20:00:00', 21.5, 12.3, 1),
  (32.2, 50, '2023-06-06', 1, '21:00:00', 19.4, 13.3, 1),
      
  (32.2, 50, '2023-06-07', 1, '12:00:00', 22.5, 13.3, 1),
  (32.2, 50, '2023-06-07', 1, '13:00:00', 21.5, 16.3, 1),
  (32.2, 50, '2023-06-07', 1, '14:00:00', 19.5, 14.4, 1),
  (32.2, 50, '2023-06-07', 1, '15:00:00', 12.2, 15.3, 1),
  (32.2, 50, '2023-06-07', 1, '16:00:00', 21.2, 16.7, 1),
  (32.2, 50, '2023-06-07', 1, '17:00:00', 25.5, 12.9, 1),
  (32.2, 50, '2023-06-07', 1, '18:00:00', 15.5, 19.3, 1),
  (32.2, 50, '2023-06-07', 1, '19:00:00', 23.5, 18.3, 1),
  (32.2, 50, '2023-06-07', 1, '20:00:00', 21.5, 12.3, 1),
  (32.2, 50, '2023-06-07', 1, '21:00:00', 19.4, 13.3, 1),
  
  (32.2, 50, '2023-06-08', 1, '12:00:00', 22.5, 13.3, 1),
  (32.2, 50, '2023-06-08', 1, '13:00:00', 21.5, 16.3, 1),
  (32.2, 50, '2023-06-08', 1, '14:00:00', 19.5, 14.4, 1),
  (32.2, 50, '2023-06-08', 1, '15:00:00', 12.2, 15.3, 1),
  (32.2, 50, '2023-06-08', 1, '16:00:00', 21.2, 16.7, 1),
  (32.2, 50, '2023-06-08', 1, '17:00:00', 25.5, 12.9, 1),
  (32.2, 50, '2023-06-08', 1, '18:00:00', 15.5, 19.3, 1),
  (32.2, 50, '2023-06-08', 1, '19:00:00', 23.5, 18.3, 1),
  (32.2, 50, '2023-06-08', 1, '20:00:00', 21.5, 12.3, 1),
  (32.2, 50, '2023-06-08', 1, '21:00:00', 19.4, 13.3, 1), 
  
  (32.2, 50, '2023-07-01', 1, '12:00:00', 25.5, 11.3, 1),
  (32.2, 50, '2023-07-01', 1, '13:00:00', 20.5, 12.3, 1),
  (32.2, 50, '2023-07-01', 1, '14:00:00', 21.5, 10.4, 1),
  (32.2, 50, '2023-07-01', 1, '15:00:00', 12.5, 10.3, 1),
  (32.2, 50, '2023-07-01', 1, '16:00:00', 30.2, 11.7, 1),
  (32.2, 50, '2023-07-01', 1, '17:00:00', 22.5, 14.9, 1),
  (32.2, 50, '2023-07-01', 1, '18:00:00', 25.5, 16.3, 1),
  (32.2, 50, '2023-07-01', 1, '19:00:00', 28.5, 14.3, 1),
  (32.2, 50, '2023-07-01', 1, '20:00:00', 21.5, 11.3, 1),
  (32.2, 50, '2023-07-01', 1, '21:00:00', 19.4, 11.3, 1),
  
  (32.2, 50, '2023-07-02', 1, '12:00:00', 25.5, 11.3, 1),
  (32.2, 50, '2023-07-02', 1, '13:00:00', 20.5, 12.3, 1),
  (32.2, 50, '2023-07-02', 1, '14:00:00', 21.5, 10.4, 1),
  (32.2, 50, '2023-07-02', 1, '15:00:00', 12.5, 10.3, 1),
  (32.2, 50, '2023-07-02', 1, '16:00:00', 30.2, 11.7, 1),
  (32.2, 50, '2023-07-02', 1, '17:00:00', 22.5, 14.9, 1),
  (32.2, 50, '2023-07-02', 1, '18:00:00', 25.5, 16.3, 1),
  (32.2, 50, '2023-07-02', 1, '19:00:00', 28.5, 14.3, 1),
  (32.2, 50, '2023-07-02', 1, '20:00:00', 21.5, 11.3, 1),
  (32.2, 50, '2023-07-02', 1, '21:00:00', 19.4, 11.3, 1),
  
  (32.2, 50, '2023-07-03', 1, '12:00:00', 22.5, 13.3, 1),
  (32.2, 50, '2023-07-03', 1, '13:00:00', 21.5, 16.3, 1),
  (32.2, 50, '2023-07-03', 1, '14:00:00', 19.5, 14.4, 1),
  (32.2, 50, '2023-07-03', 1, '15:00:00', 12.2, 15.3, 1),
  (32.2, 50, '2023-07-03', 1, '16:00:00', 21.2, 16.7, 1),
  (32.2, 50, '2023-07-03', 1, '17:00:00', 25.5, 12.9, 1),
  (32.2, 50, '2023-07-03', 1, '18:00:00', 15.5, 19.3, 1),
  (32.2, 50, '2023-07-03', 1, '19:00:00', 23.5, 18.3, 1),
  (32.2, 50, '2023-07-03', 1, '20:00:00', 21.5, 12.3, 1),
  (32.2, 50, '2023-07-03', 1, '21:00:00', 19.4, 13.3, 1),
  
  (32.2, 50, '2023-07-04', 1, '12:00:00', 22.5, 13.3, 1),
  (32.2, 50, '2023-07-04', 1, '13:00:00', 21.5, 16.3, 1),
  (32.2, 50, '2023-07-04', 1, '14:00:00', 19.5, 14.4, 1),
  (32.2, 50, '2023-07-04', 1, '15:00:00', 12.2, 15.3, 1),
  (32.2, 50, '2023-07-04', 1, '16:00:00', 21.2, 16.7, 1),
  (32.2, 50, '2023-07-04', 1, '17:00:00', 25.5, 12.9, 1),
  (32.2, 50, '2023-07-04', 1, '18:00:00', 15.5, 19.3, 1),
  (32.2, 50, '2023-07-04', 1, '19:00:00', 23.5, 18.3, 1),
  (32.2, 50, '2023-07-04', 1, '20:00:00', 21.5, 12.3, 1),
  (32.2, 50, '2023-07-04', 1, '21:00:00', 19.4, 13.3, 1),
  
  (32.2, 50, '2023-07-05', 1, '12:00:00', 22.5, 13.3, 1),
  (32.2, 50, '2023-07-05', 1, '13:00:00', 21.5, 16.3, 1),
  (32.2, 50, '2023-07-05', 1, '14:00:00', 19.5, 14.4, 1),
  (32.2, 50, '2023-07-05', 1, '15:00:00', 12.2, 15.3, 1),
  (32.2, 50, '2023-07-05', 1, '16:00:00', 21.2, 16.7, 1),
  (32.2, 50, '2023-07-05', 1, '17:00:00', 25.5, 12.9, 1),
  (32.2, 50, '2023-07-05', 1, '18:00:00', 15.5, 19.3, 1),
  (32.2, 50, '2023-07-05', 1, '19:00:00', 23.5, 18.3, 1),
  (32.2, 50, '2023-07-05', 1, '20:00:00', 21.5, 12.3, 1),
  (32.2, 50, '2023-07-05', 1, '21:00:00', 19.4, 13.3, 1),
  
      
  (32.2, 50, '2023-07-06', 1, '12:00:00', 22.5, 13.3, 1),
  (32.2, 50, '2023-07-06', 1, '13:00:00', 21.5, 16.3, 1),
  (32.2, 50, '2023-07-06', 1, '14:00:00', 19.5, 14.4, 1),
  (32.2, 50, '2023-07-06', 1, '15:00:00', 12.2, 15.3, 1),
  (32.2, 50, '2023-07-06', 1, '16:00:00', 21.2, 16.7, 1),
  (32.2, 50, '2023-07-06', 1, '17:00:00', 25.5, 12.9, 1),
  (32.2, 50, '2023-07-06', 1, '18:00:00', 15.5, 19.3, 1),
  (32.2, 50, '2023-07-06', 1, '19:00:00', 23.5, 18.3, 1),
  (32.2, 50, '2023-07-06', 1, '20:00:00', 21.5, 12.3, 1),
  (32.2, 50, '2023-07-06', 1, '21:00:00', 19.4, 13.3, 1),
      
  (32.2, 50, '2023-07-07', 1, '12:00:00', 22.5, 13.3, 1),
  (32.2, 50, '2023-07-07', 1, '13:00:00', 21.5, 16.3, 1),
  (32.2, 50, '2023-07-07', 1, '14:00:00', 19.5, 14.4, 1),
  (32.2, 50, '2023-07-07', 1, '15:00:00', 12.2, 15.3, 1),
  (32.2, 50, '2023-07-07', 1, '16:00:00', 21.2, 16.7, 1),
  (32.2, 50, '2023-07-07', 1, '17:00:00', 25.5, 12.9, 1),
  (32.2, 50, '2023-07-07', 1, '18:00:00', 15.5, 19.3, 1),
  (32.2, 50, '2023-07-07', 1, '19:00:00', 23.5, 18.3, 1),
  (32.2, 50, '2023-07-07', 1, '20:00:00', 21.5, 12.3, 1),
  (32.2, 50, '2023-07-07', 1, '21:00:00', 19.4, 13.3, 1),
  
  (32.2, 50, '2023-07-08', 1, '12:00:00', 22.5, 13.3, 1),
  (32.2, 50, '2023-07-08', 1, '13:00:00', 21.5, 16.3, 1),
  (32.2, 50, '2023-07-08', 1, '14:00:00', 19.5, 14.4, 1),
  (32.2, 50, '2023-07-08', 1, '15:00:00', 12.2, 15.3, 1),
  (32.2, 50, '2023-07-08', 1, '16:00:00', 21.2, 16.7, 1),
  (32.2, 50, '2023-07-08', 1, '17:00:00', 25.5, 12.9, 1),
  (32.2, 50, '2023-07-08', 1, '18:00:00', 15.5, 19.3, 1),
  (32.2, 50, '2023-07-08', 1, '19:00:00', 23.5, 18.3, 1),
  (32.2, 50, '2023-07-08', 1, '20:00:00', 21.5, 12.3, 1),
  (32.2, 50, '2023-07-08', 1, '21:00:00', 19.4, 13.3, 1);
  
  
INSERT INTO detalle_baterias (corriente, carga, dia, est_dc, hora, temperatura, voltaje, bat_id)
VALUES
  (32.2, 50, '2023-06-01', 1, '12:00:00', 25.5, 11.3, 2),
  (32.2, 50, '2023-06-01', 1, '13:00:00', 20.5, 12.3, 2),
  (32.2, 50, '2023-06-01', 1, '14:00:00', 21.5, 10.4, 2),
  (32.2, 50, '2023-06-01', 1, '15:00:00', 12.5, 10.3, 2),
  (32.2, 50, '2023-06-01', 1, '16:00:00', 30.2, 11.7, 2),
  (32.2, 50, '2023-06-01', 1, '17:00:00', 22.5, 14.9, 2),
  (32.2, 50, '2023-06-01', 1, '18:00:00', 25.5, 16.3, 2),
  (32.2, 50, '2023-06-01', 1, '19:00:00', 28.5, 14.3, 2),
  (32.2, 50, '2023-06-01', 1, '20:00:00', 21.5, 11.3, 2),
  (32.2, 50, '2023-06-01', 1, '21:00:00', 19.4, 11.3, 2),
  
  (32.2, 50, '2023-06-02', 1, '12:00:00', 25.5, 11.3, 2),
  (32.2, 50, '2023-06-02', 1, '13:00:00', 20.5, 12.3, 2),
  (32.2, 50, '2023-06-02', 1, '14:00:00', 21.5, 10.4, 2),
  (32.2, 50, '2023-06-02', 1, '15:00:00', 12.5, 10.3, 2),
  (32.2, 50, '2023-06-02', 1, '16:00:00', 30.2, 11.7, 2),
  (32.2, 50, '2023-06-02', 1, '17:00:00', 22.5, 14.9, 2),
  (32.2, 50, '2023-06-02', 1, '18:00:00', 25.5, 16.3, 2),
  (32.2, 50, '2023-06-02', 1, '19:00:00', 28.5, 14.3, 2),
  (32.2, 50, '2023-06-02', 1, '20:00:00', 21.5, 11.3, 2),
  (32.2, 50, '2023-06-02', 1, '21:00:00', 19.4, 11.3, 2),

  (32.2, 50, '2023-06-03', 1, '12:00:00', 22.5, 13.3, 2),
  (32.2, 50, '2023-06-03', 1, '13:00:00', 21.5, 16.3, 2),
  (32.2, 50, '2023-06-03', 1, '14:00:00', 19.5, 14.4, 2),
  (32.2, 50, '2023-06-03', 1, '15:00:00', 12.2, 15.3, 2),
  (32.2, 50, '2023-06-03', 1, '16:00:00', 21.2, 16.7, 2),
  (32.2, 50, '2023-06-03', 1, '17:00:00', 25.5, 12.9, 2),
  (32.2, 50, '2023-06-03', 1, '18:00:00', 15.5, 19.3, 2),
  (32.2, 50, '2023-06-03', 1, '19:00:00', 23.5, 18.3, 2),
  (32.2, 50, '2023-06-03', 1, '20:00:00', 21.5, 12.3, 2),
  (32.2, 50, '2023-06-03', 1, '21:00:00', 19.4, 13.3, 2),
  
  (32.2, 50, '2023-06-04', 1, '12:00:00', 22.5, 13.3, 2),
  (32.2, 50, '2023-06-04', 1, '13:00:00', 21.5, 16.3, 2),
  (32.2, 50, '2023-06-04', 1, '14:00:00', 19.5, 14.4, 2),
  (32.2, 50, '2023-06-04', 1, '15:00:00', 12.2, 15.3, 2),
  (32.2, 50, '2023-06-04', 1, '16:00:00', 21.2, 16.7, 2),
  (32.2, 50, '2023-06-04', 1, '17:00:00', 25.5, 12.9, 2),
  (32.2, 50, '2023-06-04', 1, '18:00:00', 15.5, 19.3, 2),
  (32.2, 50, '2023-06-04', 1, '19:00:00', 23.5, 18.3, 2),
  (32.2, 50, '2023-06-04', 1, '20:00:00', 21.5, 12.3, 2),
  (32.2, 50, '2023-06-04', 1, '21:00:00', 19.4, 13.3, 2),
  
    
  (32.2, 50, '2023-06-05', 1, '12:00:00', 22.5, 13.3, 2),
  (32.2, 50, '2023-06-05', 1, '13:00:00', 21.5, 16.3, 2),
  (32.2, 50, '2023-06-05', 1, '14:00:00', 19.5, 14.4, 2),
  (32.2, 50, '2023-06-05', 1, '15:00:00', 12.2, 15.3, 2),
  (32.2, 50, '2023-06-05', 1, '16:00:00', 21.2, 16.7, 2),
  (32.2, 50, '2023-06-05', 1, '17:00:00', 25.5, 12.9, 2),
  (32.2, 50, '2023-06-05', 1, '18:00:00', 15.5, 19.3, 2),
  (32.2, 50, '2023-06-05', 1, '19:00:00', 23.5, 18.3, 2),
  (32.2, 50, '2023-06-05', 1, '20:00:00', 21.5, 12.3, 2),
  (32.2, 50, '2023-06-05', 1, '21:00:00', 19.4, 13.3, 2),
  
      
  (32.2, 50, '2023-06-06', 1, '12:00:00', 22.5, 13.3, 2),
  (32.2, 50, '2023-06-06', 1, '13:00:00', 21.5, 16.3, 2),
  (32.2, 50, '2023-06-06', 1, '14:00:00', 19.5, 14.4, 2),
  (32.2, 50, '2023-06-06', 1, '15:00:00', 12.2, 15.3, 2),
  (32.2, 50, '2023-06-06', 1, '16:00:00', 21.2, 16.7, 2),
  (32.2, 50, '2023-06-06', 1, '17:00:00', 25.5, 12.9, 2),
  (32.2, 50, '2023-06-06', 1, '18:00:00', 15.5, 19.3, 2),
  (32.2, 50, '2023-06-06', 1, '19:00:00', 23.5, 18.3, 2),
  (32.2, 50, '2023-06-06', 1, '20:00:00', 21.5, 12.3, 2),
  (32.2, 50, '2023-06-06', 1, '21:00:00', 19.4, 13.3, 2),
      
  (32.2, 50, '2023-06-07', 1, '12:00:00', 22.5, 13.3, 2),
  (32.2, 50, '2023-06-07', 1, '13:00:00', 21.5, 16.3, 2),
  (32.2, 50, '2023-06-07', 1, '14:00:00', 19.5, 14.4, 2),
  (32.2, 50, '2023-06-07', 1, '15:00:00', 12.2, 15.3, 2),
  (32.2, 50, '2023-06-07', 1, '16:00:00', 21.2, 16.7, 2),
  (32.2, 50, '2023-06-07', 1, '17:00:00', 25.5, 12.9, 2),
  (32.2, 50, '2023-06-07', 1, '18:00:00', 15.5, 19.3, 2),
  (32.2, 50, '2023-06-07', 1, '19:00:00', 23.5, 18.3, 2),
  (32.2, 50, '2023-06-07', 1, '20:00:00', 21.5, 12.3, 2),
  (32.2, 50, '2023-06-07', 1, '21:00:00', 19.4, 13.3, 2),
  
  (32.2, 50, '2023-06-08', 1, '12:00:00', 22.5, 13.3, 2),
  (32.2, 50, '2023-06-08', 1, '13:00:00', 21.5, 16.3, 2),
  (32.2, 50, '2023-06-08', 1, '14:00:00', 19.5, 14.4, 2),
  (32.2, 50, '2023-06-08', 1, '15:00:00', 12.2, 15.3, 2),
  (32.2, 50, '2023-06-08', 1, '16:00:00', 21.2, 16.7, 2),
  (32.2, 50, '2023-06-08', 1, '17:00:00', 25.5, 12.9, 2),
  (32.2, 50, '2023-06-08', 1, '18:00:00', 15.5, 19.3, 2),
  (32.2, 50, '2023-06-08', 1, '19:00:00', 23.5, 18.3, 2),
  (32.2, 50, '2023-06-08', 1, '20:00:00', 21.5, 12.3, 2),
  (32.2, 50, '2023-06-08', 1, '21:00:00', 19.4, 13.3, 2), 
  
  (32.2, 50, '2023-07-01', 1, '12:00:00', 25.5, 11.3, 2),
  (32.2, 50, '2023-07-01', 1, '13:00:00', 20.5, 12.3, 2),
  (32.2, 50, '2023-07-01', 1, '14:00:00', 21.5, 10.4, 2),
  (32.2, 50, '2023-07-01', 1, '15:00:00', 12.5, 10.3, 2),
  (32.2, 50, '2023-07-01', 1, '16:00:00', 30.2, 11.7, 2),
  (32.2, 50, '2023-07-01', 1, '17:00:00', 22.5, 14.9, 2),
  (32.2, 50, '2023-07-01', 1, '18:00:00', 25.5, 16.3, 2),
  (32.2, 50, '2023-07-01', 1, '19:00:00', 28.5, 14.3, 2),
  (32.2, 50, '2023-07-01', 1, '20:00:00', 21.5, 11.3, 2),
  (32.2, 50, '2023-07-01', 1, '21:00:00', 19.4, 11.3, 2),
  
  (32.2, 50, '2023-07-02', 1, '12:00:00', 25.5, 11.3, 2),
  (32.2, 50, '2023-07-02', 1, '13:00:00', 20.5, 12.3, 2),
  (32.2, 50, '2023-07-02', 1, '14:00:00', 21.5, 10.4, 2),
  (32.2, 50, '2023-07-02', 1, '15:00:00', 12.5, 10.3, 2),
  (32.2, 50, '2023-07-02', 1, '16:00:00', 30.2, 11.7, 2),
  (32.2, 50, '2023-07-02', 1, '17:00:00', 22.5, 14.9, 2),
  (32.2, 50, '2023-07-02', 1, '18:00:00', 25.5, 16.3, 2),
  (32.2, 50, '2023-07-02', 1, '19:00:00', 28.5, 14.3, 2),
  (32.2, 50, '2023-07-02', 1, '20:00:00', 21.5, 11.3, 2),
  (32.2, 50, '2023-07-02', 1, '21:00:00', 19.4, 11.3, 2),
  
  (32.2, 50, '2023-07-03', 1, '12:00:00', 22.5, 13.3, 2),
  (32.2, 50, '2023-07-03', 1, '13:00:00', 21.5, 16.3, 2),
  (32.2, 50, '2023-07-03', 1, '14:00:00', 19.5, 14.4, 2),
  (32.2, 50, '2023-07-03', 1, '15:00:00', 12.2, 15.3, 2),
  (32.2, 50, '2023-07-03', 1, '16:00:00', 21.2, 16.7, 2),
  (32.2, 50, '2023-07-03', 1, '17:00:00', 25.5, 12.9, 2),
  (32.2, 50, '2023-07-03', 1, '18:00:00', 15.5, 19.3, 2),
  (32.2, 50, '2023-07-03', 1, '19:00:00', 23.5, 18.3, 2),
  (32.2, 50, '2023-07-03', 1, '20:00:00', 21.5, 12.3, 2),
  (32.2, 50, '2023-07-03', 1, '21:00:00', 19.4, 13.3, 2),
  
  (32.2, 50, '2023-07-04', 1, '12:00:00', 22.5, 13.3, 2),
  (32.2, 50, '2023-07-04', 1, '13:00:00', 21.5, 16.3, 2),
  (32.2, 50, '2023-07-04', 1, '14:00:00', 19.5, 14.4, 2),
  (32.2, 50, '2023-07-04', 1, '15:00:00', 12.2, 15.3, 2),
  (32.2, 50, '2023-07-04', 1, '16:00:00', 21.2, 16.7, 2),
  (32.2, 50, '2023-07-04', 1, '17:00:00', 25.5, 12.9, 2),
  (32.2, 50, '2023-07-04', 1, '18:00:00', 15.5, 19.3, 2),
  (32.2, 50, '2023-07-04', 1, '19:00:00', 23.5, 18.3, 2),
  (32.2, 50, '2023-07-04', 1, '20:00:00', 21.5, 12.3, 2),
  (32.2, 50, '2023-07-04', 1, '21:00:00', 19.4, 13.3, 2),
  
  (32.2, 50, '2023-07-05', 1, '12:00:00', 22.5, 13.3, 2),
  (32.2, 50, '2023-07-05', 1, '13:00:00', 21.5, 16.3, 2),
  (32.2, 50, '2023-07-05', 1, '14:00:00', 19.5, 14.4, 2),
  (32.2, 50, '2023-07-05', 1, '15:00:00', 12.2, 15.3, 2),
  (32.2, 50, '2023-07-05', 1, '16:00:00', 21.2, 16.7, 2),
  (32.2, 50, '2023-07-05', 1, '17:00:00', 25.5, 12.9, 2),
  (32.2, 50, '2023-07-05', 1, '18:00:00', 15.5, 19.3, 2),
  (32.2, 50, '2023-07-05', 1, '19:00:00', 23.5, 18.3, 2),
  (32.2, 50, '2023-07-05', 1, '20:00:00', 21.5, 12.3, 2),
  (32.2, 50, '2023-07-05', 1, '21:00:00', 19.4, 13.3, 2),
  
  (32.2, 50, '2023-07-06', 1, '12:00:00', 22.5, 13.3, 2),
  (32.2, 50, '2023-07-06', 1, '13:00:00', 21.5, 16.3, 2),
  (32.2, 50, '2023-07-06', 1, '14:00:00', 19.5, 14.4, 2),
  (32.2, 50, '2023-07-06', 1, '15:00:00', 12.2, 15.3, 2),
  (32.2, 50, '2023-07-06', 1, '16:00:00', 21.2, 16.7, 2),
  (32.2, 50, '2023-07-06', 1, '17:00:00', 25.5, 12.9, 2),
  (32.2, 50, '2023-07-06', 1, '18:00:00', 15.5, 19.3, 2),
  (32.2, 50, '2023-07-06', 1, '19:00:00', 23.5, 18.3, 2),
  (32.2, 50, '2023-07-06', 1, '20:00:00', 21.5, 12.3, 2),
  (32.2, 50, '2023-07-06', 1, '21:00:00', 19.4, 13.3, 2),
      
  (32.2, 50, '2023-07-07', 1, '12:00:00', 22.5, 13.3, 2),
  (32.2, 50, '2023-07-07', 1, '13:00:00', 21.5, 16.3, 2),
  (32.2, 50, '2023-07-07', 1, '14:00:00', 19.5, 14.4, 2),
  (32.2, 50, '2023-07-07', 1, '15:00:00', 12.2, 15.3, 2),
  (32.2, 50, '2023-07-07', 1, '16:00:00', 21.2, 16.7, 2),
  (32.2, 50, '2023-07-07', 1, '17:00:00', 25.5, 12.9, 2),
  (32.2, 50, '2023-07-07', 1, '18:00:00', 15.5, 19.3, 2),
  (32.2, 50, '2023-07-07', 1, '19:00:00', 23.5, 18.3, 2),
  (32.2, 50, '2023-07-07', 1, '20:00:00', 21.5, 12.3, 2),
  (32.2, 50, '2023-07-07', 1, '21:00:00', 19.4, 13.3, 2),
  
  (32.2, 50, '2023-07-08', 1, '12:00:00', 22.5, 13.3, 2),
  (32.2, 50, '2023-07-08', 1, '13:00:00', 21.5, 16.3, 2),
  (32.2, 50, '2023-07-08', 1, '14:00:00', 19.5, 14.4, 2),
  (32.2, 50, '2023-07-08', 1, '15:00:00', 12.2, 15.3, 2),
  (32.2, 50, '2023-07-08', 1, '16:00:00', 21.2, 16.7, 2),
  (32.2, 50, '2023-07-08', 1, '17:00:00', 25.5, 12.9, 2),
  (32.2, 50, '2023-07-08', 1, '18:00:00', 15.5, 19.3, 2),
  (32.2, 50, '2023-07-08', 1, '19:00:00', 23.5, 18.3, 2),
  (32.2, 50, '2023-07-08', 1, '20:00:00', 21.5, 12.3, 2),
  (32.2, 50, '2023-07-08', 1, '21:00:00', 19.4, 13.3, 2);
  
  
  -- Arranques --
  
  INSERT INTO arranques (corriente, dia, hora, camion, empresa) 
VALUES 
(60.5, '2023-06-01', '10:00:00', 1, 1),
(70.2, '2023-06-01', '14:00:00', 1, 1),
(80.3, '2023-06-01', '16:00:00', 1, 1),

(60.1, '2023-06-02', '12:00:00', 1, 1),
(60.4, '2023-06-02', '14:00:00', 1, 1),
(72.2, '2023-06-02', '15:00:00', 1, 1),

(65.3, '2023-06-03', '13:00:00', 1, 1),
(74.1, '2023-06-03', '18:00:00', 1, 1),

(73.8, '2023-06-04', '11:00:00', 1, 1),
(62.7, '2023-06-04', '17:00:00', 1, 1),

(60.5, '2023-06-05', '10:00:00', 1, 1),
(70.2, '2023-06-05', '14:00:00', 1, 1),
(80.3, '2023-06-05', '16:00:00', 1, 1),

(60.1, '2023-06-06', '12:00:00', 1, 1),
(60.4, '2023-06-06', '14:00:00', 1, 1),
(72.2, '2023-06-06', '15:00:00', 1, 1),

(65.3, '2023-06-07', '13:00:00', 1, 1),
(74.1, '2023-06-07', '18:00:00', 1, 1),

(73.8, '2023-06-08', '11:00:00', 1, 1),
(62.7, '2023-06-08', '17:00:00', 1, 1),

(60.5, '2023-07-01', '10:00:00', 1, 1),
(70.2, '2023-07-01', '14:00:00', 1, 1),
(80.3, '2023-07-01', '16:00:00', 1, 1),

(60.1, '2023-07-02', '12:00:00', 1, 1),
(60.4, '2023-07-02', '14:00:00', 1, 1),
(72.2, '2023-07-02', '15:00:00', 1, 1),

(65.3, '2023-07-03', '13:00:00', 1, 1),
(74.1, '2023-07-03', '18:00:00', 1, 1),

(73.8, '2023-07-04', '11:00:00', 1, 1),
(62.7, '2023-07-04', '17:00:00', 1, 1),

(60.5, '2023-07-05', '10:00:00', 1, 1),
(70.2, '2023-07-05', '14:00:00', 1, 1),
(80.3, '2023-07-05', '16:00:00', 1, 1),

(60.1, '2023-07-06', '12:00:00', 1, 1),
(60.4, '2023-07-06', '14:00:00', 1, 1),
(72.2, '2023-07-06', '15:00:00', 1, 1),

(65.3, '2023-07-07', '13:00:00', 1, 1),
(74.1, '2023-07-07', '18:00:00', 1, 1),

(73.8, '2023-07-08', '11:00:00', 1, 1),
(62.7, '2023-07-08', '17:00:00', 1, 1);
  

DROP PROCEDURE IF EXISTS PromedioArranquesDiaxMes;
DELIMITER //
CREATE PROCEDURE PromedioArranquesDiaxMes(IN camion INT)
BEGIN
    DECLARE fecha_inicio DATE;
    DECLARE fecha_fin DATE;
    DECLARE ultimo_mes DATE;
    
    -- Obtener el último mes del último registro
    SELECT MAX(dia) INTO ultimo_mes FROM arranques WHERE camion = camion;
    
    -- Obtener la fecha de inicio y fin del último mes
    SET fecha_inicio = DATE_SUB(LAST_DAY(ultimo_mes), INTERVAL 1 MONTH) + INTERVAL 1 DAY;
    SET fecha_fin = LAST_DAY(ultimo_mes);
    
    SELECT dia, AVG(corriente) AS promedio_corriente, count(*) as contador
    FROM arranques a
    WHERE a.camion = camion AND dia >= fecha_inicio AND dia <= fecha_fin
    GROUP BY dia;
END //
DELIMITER ;

CALL PromedioArranquesDiaxMes(1);


DROP PROCEDURE IF EXISTS PromedioDetalleDiaxMes;
DELIMITER //
CREATE PROCEDURE PromedioDetalleDiaxMes(IN bateria int)
BEGIN
    DECLARE fecha_inicio DATE;
    DECLARE fecha_fin DATE;
    DECLARE ultimo_mes DATE;
    
    -- Obtener el último mes del último registro para la batería específica
    SELECT MAX(dia) INTO ultimo_mes FROM detalle_baterias WHERE bat_id = bateria;
    
    -- Obtener la fecha de inicio y fin del último mes
    SET fecha_inicio = DATE_SUB(LAST_DAY(ultimo_mes), INTERVAL 1 MONTH) + INTERVAL 1 DAY;
    SET fecha_fin = LAST_DAY(ultimo_mes);
    
    SELECT dia, AVG(voltaje) AS promedio_voltaje, AVG(carga) AS promedio_carga, AVG(corriente) AS promedio_corriente, AVG(temperatura) AS promedio_temperatura, COUNT(*) AS conteo
    FROM detalle_baterias
    WHERE bat_id = bateria AND dia >= fecha_inicio AND dia <= fecha_fin
    GROUP BY dia;
END //
DELIMITER ;



CALL PromedioDetalleDiaxMes(1);

select * from detalle_baterias;


-- ********************************** 

DROP PROCEDURE IF EXISTS ObtenerDatosUltimoDiaPorBateria;
DELIMITER //

CREATE PROCEDURE ObtenerDatosUltimoDiaPorBateria(IN bateria int)
BEGIN
    DECLARE done INT DEFAULT FALSE;
    DECLARE bateria_id INT;
    DECLARE cur CURSOR FOR SELECT DISTINCT bat_id FROM detalle_baterias;
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;



        SELECT *
        FROM detalle_baterias
        WHERE bat_id = bateria
        ORDER BY dia DESC, hora DESC
END //

DELIMITER ;

CALL ObtenerDatosUltimoDiaPorBateria(1);


